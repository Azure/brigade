apiVersion: brigade.sh/v1
kind: PipelineComponent
metadata:
  name: kaniko-build
spec:
  params:
    - name: dockerFile
      type: string
    - name: imageTag
      type: string
    - name: registry-secret
      type: string
    - name: buildContext
      type: string
  template:
    image: gcr.io/kaniko-project/executor:latest
    args:
      - --dockerfile={{dockerFile}}
      - --context={{buildContext}}
      - --destination={{imageTag}}
    env:
      - name: CREDS
        value: asdf
    secrets:
      - name: "{{registry-secret}}"
